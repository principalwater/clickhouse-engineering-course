# –î–æ–º–∞—à–Ω–µ–µ –∑–∞–¥–∞–Ω–∏–µ ‚Ññ11: –ú—É—Ç–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ —Å –ø–∞—Ä—Ç–∏—Ü–∏—è–º–∏

---

## –û–≥–ª–∞–≤–ª–µ–Ω–∏–µ
- [–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è –∏ —Ü–µ–ª–∏](#–æ–ø–∏—Å–∞–Ω–∏–µ-–∑–∞–¥–∞–Ω–∏—è-–∏-—Ü–µ–ª–∏)
- [–¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞](#—Ç–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è-—Å–ø—Ä–∞–≤–∫–∞)
- [–ß–∞—Å—Ç—å 1. –û—Å–Ω–æ–≤–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ](#—á–∞—Å—Ç—å-1-–æ—Å–Ω–æ–≤–Ω–æ–µ-–∑–∞–¥–∞–Ω–∏–µ)
  - [–®–∞–≥ 1.1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è](#—à–∞–≥-11-–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞-–æ–∫—Ä—É–∂–µ–Ω–∏—è)
  - [–®–∞–≥ 1.2. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü](#—à–∞–≥-12-—Å–æ–∑–¥–∞–Ω–∏–µ-—Ç–∞–±–ª–∏—Ü)
  - [–®–∞–≥ 1.3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –≤—Å—Ç–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö](#—à–∞–≥-13-–≥–µ–Ω–µ—Ä–∞—Ü–∏—è-–∏-–≤—Å—Ç–∞–≤–∫–∞-–¥–∞–Ω–Ω—ã—Ö)
  - [–®–∞–≥ 1.4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö](#—à–∞–≥-14-–ø—Ä–æ–≤–µ—Ä–∫–∞-—Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è-–¥–∞–Ω–Ω—ã—Ö)
  - [–®–∞–≥ 1.5. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º—É—Ç–∞—Ü–∏–∏ (UPDATE)](#—à–∞–≥-15-–≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ-–º—É—Ç–∞—Ü–∏–∏-update)
  - [–®–∞–≥ 1.6. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º—É—Ç–∞—Ü–∏–∏](#—à–∞–≥-16-–ø—Ä–æ–≤–µ—Ä–∫–∞-—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤-–º—É—Ç–∞—Ü–∏–∏)
  - [–®–∞–≥ 1.7. –ú–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ —Å –ø–∞—Ä—Ç–∏—Ü–∏—è–º–∏ (DROP PARTITION)](#—à–∞–≥-17-–º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏-—Å-–ø–∞—Ä—Ç–∏—Ü–∏—è–º–∏-drop-partition)
  - [–®–∞–≥ 1.8. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è](#—à–∞–≥-18-–ø—Ä–æ–≤–µ—Ä–∫–∞-—Å–æ—Å—Ç–æ—è–Ω–∏—è-—Ç–∞–±–ª–∏—Ü—ã-–ø–æ—Å–ª–µ-—É–¥–∞–ª–µ–Ω–∏—è)
- [–ß–∞—Å—Ç—å 2. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è](#—á–∞—Å—Ç—å-2-–¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ-–∑–∞–¥–∞–Ω–∏—è)
  - [–®–∞–≥ 2.1. –ú—É—Ç–∞—Ü–∏—è DELETE](#—à–∞–≥-21-–º—É—Ç–∞—Ü–∏—è-delete)
  - [–®–∞–≥ 2.2. –ê—Ç–æ–º–∞—Ä–Ω–∞—è –∑–∞–º–µ–Ω–∞ –ø–∞—Ä—Ç–∏—Ü–∏–∏ (REPLACE PARTITION)](#—à–∞–≥-22-–∞—Ç–æ–º–∞—Ä–Ω–∞—è-–∑–∞–º–µ–Ω–∞-–ø–∞—Ä—Ç–∏—Ü–∏–∏-replace-partition)
  - [–®–∞–≥ 2.3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –¥–∞–Ω–Ω—ã—Ö (TTL)](#—à–∞–≥-23-—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-–∂–∏–∑–Ω–µ–Ω–Ω—ã–º-—Ü–∏–∫–ª–æ–º-–¥–∞–Ω–Ω—ã—Ö-ttl)
  - [–®–∞–≥ 2.4. –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Materialized View](#—à–∞–≥-24-—Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è-–¥–∞–Ω–Ω—ã—Ö-—á–µ—Ä–µ–∑-materialized-view)
- [–û–±—â–∏–µ –≤—ã–≤–æ–¥—ã –ø–æ –∑–∞–¥–∞–Ω–∏—é](#–æ–±—â–∏–µ-–≤—ã–≤–æ–¥—ã-–ø–æ-–∑–∞–¥–∞–Ω–∏—é)
- [–°–ø–∏—Å–æ–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤](#—Å–ø–∏—Å–æ–∫-–∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤)

---

## –û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞–Ω–∏—è –∏ —Ü–µ–ª–∏
–í –¥–∞–Ω–Ω–æ–º –¥–æ–º–∞—à–Ω–µ–º –∑–∞–¥–∞–Ω–∏–∏ –±—É–¥–µ—Ç —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∞ –∫–æ–Ω—Ü–µ–ø—Ü–∏—è –º—É—Ç–∞—Ü–∏–π –¥–∞–Ω–Ω—ã—Ö –∏ –æ–ø–µ—Ä–∞—Ü–∏–π —Å –ø–∞—Ä—Ç–∏—Ü–∏—è–º–∏ –≤ ClickHouse. –≠—Ç–∏ –º–µ—Ö–∞–Ω–∏–∑–º—ã —è–≤–ª—è—é—Ç—Å—è –º–æ—â–Ω—ã–º–∏ –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞–º–∏ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –¥–∞–Ω–Ω—ã—Ö –∏ –∏—Ö –º–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏–∏ –≤ –±–æ–ª—å—à–∏—Ö —Ç–∞–±–ª–∏—Ü–∞—Ö.

**–ö–æ–º–ø–µ—Ç–µ–Ω—Ü–∏–∏, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –æ—Ç—Ä–∞–±–æ—Ç–∞–Ω—ã:**
-   –ó–Ω–∞–Ω–∏–µ –º–µ—Ç–æ–¥–æ–≤ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏ (UPDATE/DELETE) –≤ –∫–ª–∞—Å—Ç–µ—Ä–µ.
-   –ü–æ–Ω–∏–º–∞–Ω–∏–µ –º–µ—Ö–∞–Ω–∏–∑–º–∞ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã—Ö –º—É—Ç–∞—Ü–∏–π –∏ —Å–ø–æ—Å–æ–±–æ–≤ –∏—Ö –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞.
-   –ù–∞–≤—ã–∫–∏ —Ä–∞–±–æ—Ç—ã —Å –ø–∞—Ä—Ç–∏—Ü–∏—è–º–∏ (`DROP`, `REPLACE`).
-   –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ `Replicated` –∏ `Distributed` —Ç–∞–±–ª–∏—Ü –¥–ª—è –ø–æ—Å—Ç—Ä–æ–µ–Ω–∏—è –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤—ã—Ö —Å–∏—Å—Ç–µ–º.
-   –ù–∞—Å—Ç—Ä–æ–π–∫–∞ `TTL` –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã–º–∏.
-   –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ `Materialized View` –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö.

---

## –¢–µ–æ—Ä–µ—Ç–∏—á–µ—Å–∫–∞—è —Å–ø—Ä–∞–≤–∫–∞
**–ú—É—Ç–∞—Ü–∏–∏** –≤ ClickHouse (–Ω–∞–ø—Ä–∏–º–µ—Ä, `ALTER TABLE ... UPDATE/DELETE`) ‚Äî —ç—Ç–æ —Ç—è–∂–µ–ª–æ–≤–µ—Å–Ω—ã–µ, –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏. –ö–∞–∫ –æ—Ç–º–µ—á–∞–µ—Ç—Å—è –≤ [—Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏—Ö —Å—Ç–∞—Ç—å—è—Ö](https://ivan-shamaev.ru/clickhouse-101-course-on-learn-clickhouse-com/#__ClickHouse-2), –æ–Ω–∏ –Ω–µ –∏–∑–º–µ–Ω—è—é—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ –¥–∞–Ω–Ω—ã–µ "–Ω–∞ –º–µ—Å—Ç–µ". –í–º–µ—Å—Ç–æ —ç—Ç–æ–≥–æ ClickHouse –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫—É—Å–∫–∞ –¥–∞–Ω–Ω—ã—Ö (part) —Å–æ–∑–¥–∞–µ—Ç –Ω–æ–≤—ã–π, –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–π –∫—É—Å–æ–∫, –∞ –ø–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤ —Ñ–æ–Ω–æ–≤–æ–º —Ä–µ–∂–∏–º–µ –∑–∞–º–µ–Ω—è–µ—Ç –∏–º —Å—Ç–∞—Ä—ã–π. –≠—Ç–æ—Ç –ø—Ä–æ—Ü–µ—Å—Å —Ä–µ—Å—É—Ä—Å–æ–µ–º–æ–∫ –∏ –º–æ–∂–µ—Ç –∑–∞–Ω–∏–º–∞—Ç—å –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ–µ –≤—Ä–µ–º—è. –°—Ç–∞—Ç—É—Å –º—É—Ç–∞—Ü–∏–π –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç—Å—è –≤ —Å–∏—Å—Ç–µ–º–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ `system.mutations`.

**–ú–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ —Å –ø–∞—Ä—Ç–∏—Ü–∏—è–º–∏** (`DROP PARTITION`, `REPLACE PARTITION`) ‚Äî —ç—Ç–æ –±–æ–ª–µ–µ –ª–µ–≥–∫–æ–≤–µ—Å–Ω—ã–µ –æ–ø–µ—Ä–∞—Ü–∏–∏, —Ç–∞–∫ –∫–∞–∫ –æ–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –Ω–∞ —É—Ä–æ–≤–Ω–µ –º–µ—Ç–∞–¥–∞–Ω–Ω—ã—Ö, –æ–ø–µ—Ä–∏—Ä—É—è —Ü–µ–ª—ã–º–∏ –∫–∞—Ç–∞–ª–æ–≥–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö –Ω–∞ –¥–∏—Å–∫–µ. –≠—Ç–æ –¥–µ–ª–∞–µ—Ç –∏—Ö –ø—Ä–µ–¥–ø–æ—á—Ç–∏—Ç–µ–ª—å–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è –∏–ª–∏ –∞—Ç–æ–º–∞—Ä–Ω–æ–π –∑–∞–º–µ–Ω—ã –±–æ–ª—å—à–∏—Ö –æ–±—ä–µ–º–æ–≤ –¥–∞–Ω–Ω—ã—Ö.

---

## –ß–∞—Å—Ç—å 1. –û—Å–Ω–æ–≤–Ω–æ–µ –∑–∞–¥–∞–Ω–∏–µ

### –®–∞–≥ 1.1. –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è
–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–¥–∞–Ω–∏—è –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–ª–∞—Å—Ç–µ—Ä ClickHouse, —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç—ã–π —Å –ø–æ–º–æ—â—å—é Terraform –∏–∑ –∫–∞—Ç–∞–ª–æ–≥–∞ [base-infra](../base-infra/).
```sh
cd base-infra/clickhouse
terraform apply -auto-approve
```
> ‚ö†Ô∏è –ü–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∑–∞–¥–∞—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è `TF_VAR_super_user_name`, `TF_VAR_super_user_password` –∏ `TF_VAR_bi_user_password` –¥–ª—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏.

> **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –≤—Å–µ –ø–æ—Å–ª–µ–¥—É—é—â–∏–µ DDL/DML –∑–∞–ø—Ä–æ—Å—ã –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω—è—Ç—å—Å—è —Å –ø–µ—Ä–≤–æ–≥–æ —É–∑–ª–∞ (`clickhouse-01`).

### –®–∞–≥ 1.2. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü
–ë—É–¥—É—Ç —Å–æ–∑–¥–∞–Ω—ã –¥–≤–µ —Ç–∞–±–ª–∏—Ü—ã: `user_activity_local` –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ `user_activity` –¥–ª—è —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ —Å—Ö–µ–º–µ `otus_default`.

1.  **–°–æ–∑–¥–∞–Ω–∏–µ Replicated-—Ç–∞–±–ª–∏—Ü—ã:**
    ```sql
    CREATE TABLE IF NOT EXISTS otus_default.user_activity_local ON CLUSTER dwh_test
    (
        user_id UInt32,
        activity_type Enum8('login' = 1, 'logout' = 2, 'purchase' = 3, 'view_page' = 4),
        activity_date DateTime
    )
    ENGINE = ReplicatedMergeTree('/clickhouse/tables/{shard}/user_activity/{uuid}', '{replica}')
    PARTITION BY toYYYYMM(activity_date)
    ORDER BY (user_id, activity_date);
    ```
2.  **–°–æ–∑–¥–∞–Ω–∏–µ Distributed-—Ç–∞–±–ª–∏—Ü—ã:**
    ```sql
    CREATE TABLE IF NOT EXISTS otus_default.user_activity ON CLUSTER dwh_test AS otus_default.user_activity_local
    ENGINE = Distributed('dwh_test', 'otus_default', 'user_activity_local', cityHash64(user_id));
    ```
*–†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü:*

<img src="../screenshots/hw11_mutations-partitions/01_create_tables.png" alt="–°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü" width="600"/>

### –®–∞–≥ 1.3. –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∏ –≤—Å—Ç–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö
–í—Å—Ç–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ—Å—É—â–µ—Å—Ç–≤–ª—è–µ—Ç—Å—è –≤ `Distributed`-—Ç–∞–±–ª–∏—Ü—É. –ë—É–¥–µ—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–æ –∏ –≤—Å—Ç–∞–≤–ª–µ–Ω–æ 100 –º–∏–ª–ª–∏–æ–Ω–æ–≤ –∑–∞–ø–∏—Å–µ–π.
```sql
INSERT INTO otus_default.user_activity
SELECT
    rand() % 100000 + 1 AS user_id,
    CAST(rand() % 4 + 1, 'Enum8(\'login\' = 1, \'logout\' = 2, \'purchase\' = 3, \'view_page\' = 4)') AS activity_type,
    toDateTime('2025-01-01 00:00:00') + (rand() % 180 * 86400) AS activity_date
FROM numbers(100000000);
```
*–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—Å—Ç–∞–≤–∫–∏ –¥–∞–Ω–Ω—ã—Ö:*

<img src="../screenshots/hw11_mutations-partitions/02_01_insert_data.png" alt="–í—Å—Ç–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö" width="600"/>

### –®–∞–≥ 1.4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö
1.  **–ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø–∏—Å–µ–π –Ω–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ –æ–¥–Ω–æ–≥–æ —É–∑–ª–∞:**
    ```sql
    SELECT count() FROM otus_default.user_activity_local;
    ```
2.  **–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–±—â–µ–≥–æ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∑–∞–ø–∏—Å–µ–π —á–µ—Ä–µ–∑ Distributed-—Ç–∞–±–ª–∏—Ü—É:**
    ```sql
    SELECT count() FROM otus_default.user_activity;
    ```
> **üí° –ü–æ—á–µ–º—É –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—Ä–æ–∫ –æ—Ç–ª–∏—á–∞–µ—Ç—Å—è?**
> –≠—Ç–æ **–æ–∂–∏–¥–∞–µ–º–æ–µ –∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ** –ø–æ–≤–µ–¥–µ–Ω–∏–µ. `user_activity_local` –Ω–∞ –∫–∞–∂–¥–æ–º —É–∑–ª–µ —Ö—Ä–∞–Ω–∏—Ç –¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ **—Å–≤–æ–µ–≥–æ** —à–∞—Ä–¥–∞. `user_activity` (Distributed) –æ–ø—Ä–∞—à–∏–≤–∞–µ—Ç –≤—Å–µ —à–∞—Ä–¥—ã –∏ —Å—É–º–º–∏—Ä—É–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç. –†–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –≤ —Ü–∏—Ñ—Ä–∞—Ö –ø—Ä–∏–º–µ—Ä–Ω–æ –≤ –¥–≤–∞ —Ä–∞–∑–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–µ—Ç, —á—Ç–æ –¥–∞–Ω–Ω—ã–µ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–∏–ª–∏—Å—å –ø–æ –¥–≤—É–º —à–∞—Ä–¥–∞–º.

*–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö:*

<img src="../screenshots/hw11_mutations-partitions/02_02_check_distribution.png" alt="–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö" width="600"/>

### –®–∞–≥ 1.5. –í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º—É—Ç–∞—Ü–∏–∏ (UPDATE)
```sql
ALTER TABLE otus_default.user_activity_local ON CLUSTER dwh_test
    UPDATE activity_type = 'logout' WHERE toYYYYMM(activity_date) = 202501 AND activity_type = 'login';
```
*–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ –º—É—Ç–∞—Ü–∏—é:*

<img src="../screenshots/hw11_mutations-partitions/03_alter_update.png" alt="–í—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º—É—Ç–∞—Ü–∏–∏ UPDATE" width="600"/>

### –®–∞–≥ 1.6. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ –º—É—Ç–∞—Ü–∏–∏
1.  **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –≤ `system.mutations`:**
    ```sql
    SELECT mutation_id, command, is_done
    FROM clusterAllReplicas('dwh_test', system.mutations)
    WHERE table = 'user_activity_local' AND database = 'otus_default'
    ORDER BY create_time DESC
    LIMIT 1;
    ```
2.  **–ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–Ω–Ω—ã—Ö:**
    ```sql
    SELECT activity_type, count()
    FROM otus_default.user_activity
    WHERE toYYYYMM(activity_date) = 202501
    GROUP BY activity_type;
    ```
*–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ `system.mutations` –∏ –¥–∞–Ω–Ω—ã—Ö:*

<img src="../screenshots/hw11_mutations-partitions/04_check_update.png" alt="–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ UPDATE" width="800"/>

### –®–∞–≥ 1.7. –ú–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ —Å –ø–∞—Ä—Ç–∏—Ü–∏—è–º–∏ (DROP PARTITION)
```sql
ALTER TABLE otus_default.user_activity_local ON CLUSTER dwh_test DROP PARTITION '202502';
```

<img src="../screenshots/hw11_mutations-partitions/05_01_execute_drop.png" alt="–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ DROP" width="600"/>


### –®–∞–≥ 1.8. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è —Ç–∞–±–ª–∏—Ü—ã –ø–æ—Å–ª–µ —É–¥–∞–ª–µ–Ω–∏—è
1.  **–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (—Å—Ä–∞–∑—É –ø–æ—Å–ª–µ `DROP`):**
    ```sql
    SELECT partition, active, count()
    FROM clusterAllReplicas('dwh_test', system.parts)
    WHERE database = 'otus_default' AND table = 'user_activity_local' AND partition = '202502'
    GROUP BY partition, active;
    ```
    *–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏:*
    
    <img src="../screenshots/hw11_mutations-partitions/05_02_check_drop_intermediate.png" alt="–ü—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ DROP" width="800"/>

2.  **–§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (—á–µ—Ä–µ–∑ –Ω–µ–∫–æ—Ç–æ—Ä–æ–µ –≤—Ä–µ–º—è):**
    ```sql
    SELECT DISTINCT partition
    FROM clusterAllReplicas('dwh_test', system.parts)
    WHERE database = 'otus_default' AND table = 'user_activity_local' AND active = 1
    ORDER BY partition;
    ```
    *–†–µ–∑—É–ª—å—Ç–∞—Ç —Ñ–∏–Ω–∞–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–∞—Ä—Ç–∏—Ü–∏–π:*

    <img src="../screenshots/hw11_mutations-partitions/05_03_check_drop_final.png" alt="–§–∏–Ω–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ DROP PARTITION" width="800"/>

---

## –ß–∞—Å—Ç—å 2. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è

### –®–∞–≥ 2.1. –ú—É—Ç–∞—Ü–∏—è DELETE
```sql
ALTER TABLE otus_default.user_activity_local ON CLUSTER dwh_test
    DELETE WHERE toYYYYMM(activity_date) = 202503 AND activity_type = 'purchase';
```
–ü—Ä–æ–≤–µ—Ä–∫–∞:
```sql
SELECT count()
FROM otus_default.user_activity
WHERE toYYYYMM(activity_date) = 202503 AND activity_type = 'purchase';
```
*–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –¥–∞–Ω–Ω—ã—Ö –ø–æ—Å–ª–µ `DELETE`:*

<img src="../screenshots/hw11_mutations-partitions/06_01_check_delete.png" alt="–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ DELETE" width="600"/>

<img src="../screenshots/hw11_mutations-partitions/06_02_check_delete.png" alt="–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ DELETE" width="800"/>

### –®–∞–≥ 2.2. –ê—Ç–æ–º–∞—Ä–Ω–∞—è –∑–∞–º–µ–Ω–∞ –ø–∞—Ä—Ç–∏—Ü–∏–∏ (REPLACE PARTITION)
1.  **–°–æ–∑–¥–∞–Ω–∏–µ –≤—Ä–µ–º–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã —Å –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏:**
    ```sql
    CREATE TABLE IF NOT EXISTS otus_default.user_activity_temp ON CLUSTER dwh_test
    AS otus_default.user_activity_local
    ENGINE = ReplicatedMergeTree('/clickhouse/tables/{shard}/user_activity_temp/{uuid}', '{replica}');

    INSERT INTO otus_default.user_activity_temp
    SELECT
        user_id,
        'login' AS activity_type,
        activity_date
    FROM otus_default.user_activity_local
    WHERE toYYYYMM(activity_date) = 202504;
    ```
2.  **–ê—Ç–æ–º–∞—Ä–Ω–∞—è –∑–∞–º–µ–Ω–∞ –ø–∞—Ä—Ç–∏—Ü–∏–∏:**
    ```sql
    ALTER TABLE otus_default.user_activity_local ON CLUSTER dwh_test
        REPLACE PARTITION '202504' FROM otus_default.user_activity_temp;
    ```
3.  **–ü—Ä–æ–≤–µ—Ä–∫–∞:**
    ```sql
    SELECT activity_type, count()
    FROM otus_default.user_activity
    WHERE toYYYYMM(activity_date) = 202504
    GROUP BY activity_type;
    ```
*–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø–æ—Å–ª–µ `REPLACE PARTITION`:*

<img src="../screenshots/hw11_mutations-partitions/07_check_replace.png" alt="–ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ REPLACE" width="600"/>

### –®–∞–≥ 2.3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º —Ü–∏–∫–ª–æ–º –¥–∞–Ω–Ω—ã—Ö (TTL)
```sql
ALTER TABLE otus_default.user_activity_local ON CLUSTER dwh_test
    MODIFY TTL activity_date + INTERVAL 90 DAY;
```
–ü—Ä–æ–≤–µ—Ä–∫–∞:
```sql
SHOW CREATE TABLE otus_default.user_activity_local;
```
*–†–µ–∑—É–ª—å—Ç–∞—Ç `SHOW CREATE TABLE` —Å TTL:*

<img src="../screenshots/hw11_mutations-partitions/08_check_ttl.png" alt="–ü—Ä–æ–≤–µ—Ä–∫–∞ TTL –≤ —Å—Ö–µ–º–µ —Ç–∞–±–ª–∏—Ü—ã" width="600"/>

### –®–∞–≥ 2.4. –¢—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —á–µ—Ä–µ–∑ Materialized View
`Materialized View` (MV) –º–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –∫–∞–∫ —Ç—Ä–∏–≥–≥–µ—Ä –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö "–Ω–∞ –ª–µ—Ç—É". –û–¥–Ω–∞–∫–æ –≤ –∫–ª–∞—Å—Ç–µ—Ä–Ω–æ–π —Å—Ä–µ–¥–µ –∏—Ö –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç—Ä–µ–±—É–µ—Ç –æ—Å–æ–±–æ–≥–æ –≤–Ω–∏–º–∞–Ω–∏—è, —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö.

> **üí° –ü—Ä–∏—á–∏–Ω–∞ –¥—É–±–ª–µ–π:** –ï—Å–ª–∏ `Materialized View` —Å–ª—É—à–∞–µ—Ç –ª–æ–∫–∞–ª—å–Ω—É—é `Replicated`-—Ç–∞–±–ª–∏—Ü—É, –æ–Ω —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –Ω–∞ **–∫–∞–∂–¥–æ–π** —Ä–µ–ø–ª–∏–∫–µ, –∫—É–¥–∞ –ø—Ä–∏—Ö–æ–¥—è—Ç –¥–∞–Ω–Ω—ã–µ, —á—Ç–æ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –º–Ω–æ–≥–æ–∫—Ä–∞—Ç–Ω–æ–º—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—é –æ–¥–Ω–æ–π –∏ —Ç–æ–π –∂–µ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏.

**–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ:** `Materialized View` –¥–æ–ª–∂–µ–Ω —Å–ª—É—à–∞—Ç—å `Distributed`-—Ç–∞–±–ª–∏—Ü—É. –í —ç—Ç–æ–º —Å–ª—É—á–∞–µ `INSERT` –≤ `Distributed`-—Ç–∞–±–ª–∏—Ü—É –±—É–¥–µ—Ç –≤–∏–¥–µ–Ω –∫–∞–∫ –µ–¥–∏–Ω–æ–µ —Å–æ–±—ã—Ç–∏–µ, –∏ MV —Å—Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω —Ä–∞–∑.

1. **–°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏:**
   ```sql
   -- 1. –õ–æ–∫–∞–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞-–ø—Ä–∏–µ–º–Ω–∏–∫ –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   CREATE TABLE IF NOT EXISTS otus_default.user_activity_transformed_local ON CLUSTER dwh_test
   AS otus_default.user_activity_local
   ENGINE = ReplicatedMergeTree('/clickhouse/tables/{shard}/user_activity_transformed/{uuid}', '{replica}');

   -- 2. Materialized View: –ø–æ–¥–ø–∏—Å—ã–≤–∞–µ—Ç—Å—è –Ω–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—É—é —Ç–∞–±–ª–∏—Ü—É-–∏—Å—Ç–æ—á–Ω–∏–∫, –ø–∏—à–µ—Ç –≤ –ª–æ–∫–∞–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É-–ø—Ä–∏–µ–º–Ω–∏–∫
   CREATE MATERIALIZED VIEW IF NOT EXISTS otus_default.mv_transform_activity ON CLUSTER dwh_test
   TO otus_default.user_activity_transformed_local
   AS SELECT
       user_id,
       if(activity_type = 'purchase', 'view_page', activity_type) AS activity_type,
       activity_date
   FROM otus_default.user_activity;
   ```

2. **–í—Å—Ç–∞–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ç—Ä–∏–≥–≥–µ—Ä–∞:**
   ```sql
   INSERT INTO otus_default.user_activity (user_id, activity_type, activity_date)
   VALUES (999, 'purchase', '2025-06-01 12:00:00');
   ```

3. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:**
   –°–Ω–∞—á–∞–ª–∞ –ø—Ä–æ–≤–µ—Ä–∏–º –ª–æ–∫–∞–ª—å–Ω—É—é —Ç–∞–±–ª–∏—Ü—É –Ω–∞ –æ–¥–Ω–æ–º –∏–∑ —É–∑–ª–æ–≤. –ú—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å –æ–¥–Ω—É —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—É—é –∑–∞–ø–∏—Å—å.
   ```sql
   SELECT * FROM otus_default.user_activity_transformed_local WHERE user_id = 999;
   ```
   *–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ `_local` —Ç–∞–±–ª–∏—Ü—ã:*

   <img src="../screenshots/hw11_mutations-partitions/09_01_check_mv_local.png" alt="–ü—Ä–æ–≤–µ—Ä–∫–∞ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –ø–æ—Å–ª–µ MV" width="600"/>

   > **üí° –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –í –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–π —Å—Ä–µ–¥–µ –¥–ª—è –∑–∞–ø—Ä–æ—Å–æ–≤ –≤—Å–µ–≥–¥–∞ —Å–ª–µ–¥—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Distributed`-—Ç–∞–±–ª–∏—Ü—É. –°–æ–∑–¥–∞–¥–∏–º –µ–µ –∏ —É–±–µ–¥–∏–º—Å—è, —á—Ç–æ –∏ –Ω–∞ —É—Ä–æ–≤–Ω–µ –≤—Å–µ–≥–æ –∫–ª–∞—Å—Ç–µ—Ä–∞ –º—ã –≤–∏–¥–∏–º –æ–¥–Ω—É –∑–∞–ø–∏—Å—å.

4. **–°–æ–∑–¥–∞–Ω–∏–µ `Distributed`-—Ç–∞–±–ª–∏—Ü—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏ –æ—á–∏—Å—Ç–∫–∞:**
   ```sql
   -- –°–æ–∑–¥–∞–µ–º Distributed-—Ç–∞–±–ª–∏—Ü—É –ø–æ–≤–µ—Ä—Ö —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   CREATE TABLE IF NOT EXISTS otus_default.user_activity_transformed ON CLUSTER dwh_test
   AS otus_default.user_activity_transformed_local
   ENGINE = Distributed('dwh_test', 'otus_default', 'user_activity_transformed_local', cityHash64(user_id));

   -- –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–∞–Ω–Ω—ã–µ —á–µ—Ä–µ–∑ –Ω–µ–µ
   SELECT * FROM otus_default.user_activity_transformed WHERE user_id = 999;
   ```
   *–†–µ–∑—É–ª—å—Ç–∞—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ `Distributed`-—Ç–∞–±–ª–∏—Ü—ã:*

   <img src="../screenshots/hw11_mutations-partitions/09_02_check_mv_dist.png" alt="–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω–æ–π —Ç–∞–±–ª–∏—Ü—ã –ø–æ—Å–ª–µ MV" width="600"/>

   ```sql
   -- –§–∏–Ω–∞–ª—å–Ω–∞—è –æ—á–∏—Å—Ç–∫–∞
   DROP VIEW IF EXISTS otus_default.mv_transform_activity ON CLUSTER dwh_test;
   DROP TABLE IF EXISTS otus_default.user_activity_transformed ON CLUSTER dwh_test;
   DROP TABLE IF EXISTS otus_default.user_activity_transformed_local ON CLUSTER dwh_test;
   ```

---

## –û–±—â–∏–µ –≤—ã–≤–æ–¥—ã –ø–æ –∑–∞–¥–∞–Ω–∏—é
–í —Ö–æ–¥–µ —ç—Ç–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –Ω–∞ –ø—Ä–∞–∫—Ç–∏–∫–µ –±—ã–ª–∏ –æ—Å–≤–æ–µ–Ω—ã –º–µ—Ö–∞–Ω–∏–∑–º—ã –º—É—Ç–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –∏ –º–∞–Ω–∏–ø—É–ª—è—Ü–∏–∏ —Å –ø–∞—Ä—Ç–∏—Ü–∏—è–º–∏ –≤ –∫–ª–∞—Å—Ç–µ—Ä–Ω–æ–π —Å—Ä–µ–¥–µ ClickHouse. –ë—ã–ª–æ –ø—Ä–æ–¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–æ, –∫–∞–∫ —Å—Ç—Ä–æ–∏—Ç—å –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è —Å –ø–æ–º–æ—â—å—é `Replicated` –∏ `Distributed` —Ç–∞–±–ª–∏—Ü, –≤—ã–ø–æ–ª–Ω—è—Ç—å `UPDATE`, `DELETE`, `REPLACE PARTITION` –Ω–∞ –∫–ª–∞—Å—Ç–µ—Ä–µ, –∞ —Ç–∞–∫–∂–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞—Ç—å `TTL` –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `Materialized View` –¥–ª—è —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö.

## –°–ø–∏—Å–æ–∫ –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤
- [–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è ClickHouse: ALTER TABLE](https://clickhouse.com/docs/ru/sql-reference/statements/alter)
- [–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è ClickHouse: Materialized View](https://clickhouse.com/docs/ru/sql-reference/statements/create/view/#materialized-view)
- [–°—Ç–∞—Ç—å—è –Ω–∞ Habr: –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ ClickHouse](https://habr.com/ru/companies/just_ai/articles/589621/)
- [–°—Ç–∞—Ç—å—è –≤ –±–ª–æ–≥–µ ivan-shamaev.ru: –ß—Ç–æ —Ç–∞–∫–æ–µ –º—É—Ç–∞—Ü–∏–∏ –≤ ClickHouse?](https://ivan-shamaev.ru/clickhouse-101-course-on-learn-clickhouse-com/#__ClickHouse-2)
